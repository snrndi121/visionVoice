#GPU 사용으로 인한 12시간 max 타임에 걸려서
# 에폭 18/30 수행함. 모델 만들어짖 이낳음.
# 줄여서 다시 해보기로 함.
# 일단 로그는 저장
Using TensorFlow backend.
Parsing annotation files
Training images per class:
{'bg': 0,
 'shape_a': 560,
 'shape_e': 532,
 'shape_eu': 552,
 'shape_i': 518,
 'shape_none': 600,
 'shape_o': 590,
 'shape_u': 600,
 'shape_ui': 598}
Num classes (including bg) = 9
Config has been written to config.pickle, and can be loaded when testing to ensure correct results
Num train samples 4120
Num val samples 430
WARNING: Logging before flag parsing goes to stderr.
W0823 19:09:08.959119 139763611248512 deprecation_wrapper.py:119] From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:72: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

W0823 19:09:08.976230 139763611248512 deprecation_wrapper.py:119] From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:515: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

W0823 19:09:08.983129 139763611248512 deprecation_wrapper.py:119] From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:4048: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

W0823 19:09:09.031012 139763611248512 deprecation_wrapper.py:119] From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:1897: The name tf.nn.fused_batch_norm is deprecated. Please use tf.compat.v1.nn.fused_batch_norm instead.

W0823 19:09:09.033204 139763611248512 deprecation_wrapper.py:119] From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:3878: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

W0823 19:09:10.672168 139763611248512 deprecation_wrapper.py:119] From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:4025: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

W0823 19:09:10.724530 139763611248512 deprecation_wrapper.py:119] From /content/gdrive/My Drive/keras-frcnn/keras_frcnn/RoiPoolingConv.py:105: The name tf.image.resize_images is deprecated. Please use tf.image.resize instead.

W0823 19:09:12.053198 139763611248512 deprecation_wrapper.py:119] From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:3882: The name tf.nn.avg_pool is deprecated. Please use tf.nn.avg_pool2d instead.

loading weights from resnet50_weights_tf_dim_ordering_tf_kernels.h5
Could not load pretrained model weights. Weights can be found in the keras application folder 		https://github.com/fchollet/keras/tree/master/keras/applications
W0823 19:09:12.137161 139763611248512 deprecation_wrapper.py:119] From /usr/local/lib/python3.6/dist-packages/keras/optimizers.py:782: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

W0823 19:09:12.152150 139763611248512 deprecation_wrapper.py:119] From /usr/local/lib/python3.6/dist-packages/keras/backend/tensorflow_backend.py:3299: The name tf.log is deprecated. Please use tf.math.log instead.

W0823 19:09:12.156589 139763611248512 deprecation.py:323] From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/nn_impl.py:180: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
Starting training
Epoch 1/30
2019-08-23 19:09:16.149553: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz
2019-08-23 19:09:16.149862: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x1372d80 executing computations on platform Host. Devices:
2019-08-23 19:09:16.149896: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2019-08-23 19:09:16.152033: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2019-08-23 19:09:16.247875: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-08-23 19:09:16.248507: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x771b500 executing computations on platform CUDA. Devices:
2019-08-23 19:09:16.248569: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Tesla K80, Compute Capability 3.7
2019-08-23 19:09:16.248825: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-08-23 19:09:16.249348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:00:04.0
2019-08-23 19:09:16.249663: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2019-08-23 19:09:16.251209: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0
2019-08-23 19:09:16.252586: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10.0
2019-08-23 19:09:16.252902: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10.0
2019-08-23 19:09:16.254747: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10.0
2019-08-23 19:09:16.256209: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10.0
2019-08-23 19:09:16.260380: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2019-08-23 19:09:16.260553: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-08-23 19:09:16.261110: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-08-23 19:09:16.261592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2019-08-23 19:09:16.261674: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2019-08-23 19:09:16.262762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-08-23 19:09:16.262795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0
2019-08-23 19:09:16.262827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N
2019-08-23 19:09:16.263231: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-08-23 19:09:16.263728: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:1005] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2019-08-23 19:09:16.264130: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:40] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2019-08-23 19:09:16.264191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10802 MB memory) -> physical GPU (device: 0, name: Tesla K80, pci bus id: 0000:00:04.0, compute capability: 3.7)
2019-08-23 19:09:21.551370: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2019-08-23 19:09:36.386202: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0
  59/1000 [>.............................] - ETA: 28:37 - rpn_cls: 1.9569 - rpn_regr: 0.0969 - detector_cls: 0.2049 - detector_regr: 0.2113Exception: 'a' cannot be empty unless no samples are taken
 275/1000 [=======>......................] - ETA: 20:08 - rpn_cls: 2.0643 - rpn_regr: 0.0628 - detector_cls: 0.1401 - detector_regr: 0.1630Exception: 'a' cannot be empty unless no samples are taken
 312/1000 [========>.....................] - ETA: 19:07 - rpn_cls: 2.0488 - rpn_regr: 0.0592 - detector_cls: 0.1367 - detector_regr: 0.1572Exception: 'a' cannot be empty unless no samples are taken
 320/1000 [========>.....................] - ETA: 18:50 - rpn_cls: 2.0735 - rpn_regr: 0.0587 - detector_cls: 0.1338 - detector_regr: 0.1533Exception: 'a' cannot be empty unless no samples are taken
 329/1000 [========>.....................] - ETA: 18:36 - rpn_cls: 2.0566 - rpn_regr: 0.0577 - detector_cls: 0.1367 - detector_regr: 0.1523Exception: 'a' cannot be empty unless no samples are taken
 352/1000 [=========>....................] - ETA: 18:08 - rpn_cls: 2.0416 - rpn_regr: 0.0562 - detector_cls: 0.1346 - detector_regr: 0.1472Exception: 'a' cannot be empty unless no samples are taken
 387/1000 [==========>...................] - ETA: 17:00 - rpn_cls: 2.0102 - rpn_regr: 0.0543 - detector_cls: 0.1320 - detector_regr: 0.1440Exception: 'a' cannot be empty unless no samples are taken
 401/1000 [===========>..................] - ETA: 16:39 - rpn_cls: 2.0372 - rpn_regr: 0.0540 - detector_cls: 0.1312 - detector_regr: 0.1453Exception: 'a' cannot be empty unless no samples are taken
 500/1000 [==============>...............] - ETA: 14:01 - rpn_cls: 2.0025 - rpn_regr: 0.0525 - detector_cls: 0.1325 - detector_regr: 0.1412Exception: 'a' cannot be empty unless no samples are taken
 559/1000 [===============>..............] - ETA: 12:18 - rpn_cls: 1.9729 - rpn_regr: 0.0511 - detector_cls: 0.1272 - detector_regr: 0.1353Exception: 'a' cannot be empty unless no samples are taken
 712/1000 [====================>.........] - ETA: 7:57 - rpn_cls: 1.8559 - rpn_regr: 0.0499 - detector_cls: 0.1202 - detector_regr: 0.1329Exception: 'a' cannot be empty unless no samples are taken
 725/1000 [====================>.........] - ETA: 7:37 - rpn_cls: 1.8407 - rpn_regr: 0.0501 - detector_cls: 0.1210 - detector_regr: 0.1347Exception: 'a' cannot be empty unless no samples are taken
 795/1000 [======================>.......] - ETA: 5:38 - rpn_cls: 1.8166 - rpn_regr: 0.0486 - detector_cls: 0.1172 - detector_regr: 0.1304Exception: 'a' cannot be empty unless no samples are taken
 800/1000 [=======================>......] - ETA: 5:30 - rpn_cls: 1.8107 - rpn_regr: 0.0485 - detector_cls: 0.1170 - detector_regr: 0.1300Average number of overlapping bounding boxes from RPN = 0.413 for 1000 previous iterations
 844/1000 [========================>.....] - ETA: 4:17 - rpn_cls: 1.7982 - rpn_regr: 0.0484 - detector_cls: 0.1129 - detector_regr: 0.1255Exception: 'a' cannot be empty unless no samples are taken
 870/1000 [=========================>....] - ETA: 3:34 - rpn_cls: 1.7794 - rpn_regr: 0.0485 - detector_cls: 0.1109 - detector_regr: 0.1236Exception: 'a' cannot be empty unless no samples are taken
 875/1000 [=========================>....] - ETA: 3:26 - rpn_cls: 1.7741 - rpn_regr: 0.0483 - detector_cls: 0.1104 - detector_regr: 0.1233Exception: 'a' cannot be empty unless no samples are taken
 898/1000 [=========================>....] - ETA: 2:48 - rpn_cls: 1.7844 - rpn_regr: 0.0478 - detector_cls: 0.1093 - detector_regr: 0.1230Exception: 'a' cannot be empty unless no samples are taken
 949/1000 [===========================>..] - ETA: 1:23 - rpn_cls: 1.7762 - rpn_regr: 0.0477 - detector_cls: 0.1082 - detector_regr: 0.1227Exception: 'a' cannot be empty unless no samples are taken
1000/1000 [==============================] - 1632s 2s/step - rpn_cls: 1.7533 - rpn_regr: 0.0467 - detector_cls: 0.1162 - detector_regr: 0.1268
Mean number of bounding boxes from RPN overlapping ground truth boxes: 0.4344660194174757
Classifier accuracy for bounding boxes from RPN: 0.983
Loss RPN classifier: 1.7533449420030633
Loss RPN regression: 0.046723479873006
Loss Detector classifier: 0.11624048326509324
Loss Detector regression: 0.1267649987526238
Elapsed time: 1631.6978178024292
Total loss decreased from inf to 2.043073903893786, saving weights
Epoch 2/30
 181/1000 [====>.........................] - ETA: 19:24 - rpn_cls: 1.4384 - rpn_regr: 0.0343 - detector_cls: 0.2603 - detector_regr: 0.2428Exception: 'a' cannot be empty unless no samples are taken
 190/1000 [====>.........................] - ETA: 19:34 - rpn_cls: 1.4444 - rpn_regr: 0.0363 - detector_cls: 0.2573 - detector_regr: 0.2446Exception: 'a' cannot be empty unless no samples are taken
 234/1000 [======>.......................] - ETA: 18:20 - rpn_cls: 1.4115 - rpn_regr: 0.0348 - detector_cls: 0.2498 - detector_regr: 0.2403Exception: 'a' cannot be empty unless no samples are taken
 251/1000 [======>.......................] - ETA: 18:01 - rpn_cls: 1.3878 - rpn_regr: 0.0344 - detector_cls: 0.2480 - detector_regr: 0.2376Exception: 'a' cannot be empty unless no samples are taken
 299/1000 [=======>......................] - ETA: 17:04 - rpn_cls: 1.4263 - rpn_regr: 0.0364 - detector_cls: 0.2417 - detector_regr: 0.2341Exception: 'a' cannot be empty unless no samples are taken
 300/1000 [========>.....................] - ETA: 17:04 - rpn_cls: 1.4216 - rpn_regr: 0.0363 - detector_cls: 0.2411 - detector_regr: 0.2333Exception: 'a' cannot be empty unless no samples are taken
 305/1000 [========>.....................] - ETA: 16:58 - rpn_cls: 1.4125 - rpn_regr: 0.0361 - detector_cls: 0.2397 - detector_regr: 0.2314Exception: 'a' cannot be empty unless no samples are taken
 306/1000 [========>.....................] - ETA: 16:58 - rpn_cls: 1.4221 - rpn_regr: 0.0360 - detector_cls: 0.2411 - detector_regr: 0.2316Exception: 'a' cannot be empty unless no samples are taken
 342/1000 [=========>....................] - ETA: 16:12 - rpn_cls: 1.3784 - rpn_regr: 0.0363 - detector_cls: 0.2318 - detector_regr: 0.2272Exception: 'a' cannot be empty unless no samples are taken
Exception: 'a' cannot be empty unless no samples are taken
 421/1000 [===========>..................] - ETA: 14:23 - rpn_cls: 1.3670 - rpn_regr: 0.0367 - detector_cls: 0.2222 - detector_regr: 0.2192Exception: 'a' cannot be empty unless no samples are taken
 432/1000 [===========>..................] - ETA: 14:12 - rpn_cls: 1.3973 - rpn_regr: 0.0364 - detector_cls: 0.2233 - detector_regr: 0.2211Exception: 'a' cannot be empty unless no samples are taken
 449/1000 [============>.................] - ETA: 13:49 - rpn_cls: 1.3754 - rpn_regr: 0.0365 - detector_cls: 0.2196 - detector_regr: 0.2171Exception: 'a' cannot be empty unless no samples are taken
Exception: 'a' cannot be empty unless no samples are taken
 467/1000 [=============>................] - ETA: 13:30 - rpn_cls: 1.3835 - rpn_regr: 0.0363 - detector_cls: 0.2179 - detector_regr: 0.2168Exception: 'a' cannot be empty unless no samples are taken
 562/1000 [===============>..............] - ETA: 11:06 - rpn_cls: 1.2925 - rpn_regr: 0.0361 - detector_cls: 0.2125 - detector_regr: 0.2122Exception: 'a' cannot be empty unless no samples are taken
 575/1000 [================>.............] - ETA: 10:49 - rpn_cls: 1.3005 - rpn_regr: 0.0364 - detector_cls: 0.2111 - detector_regr: 0.2112Exception: 'a' cannot be empty unless no samples are taken
 597/1000 [================>.............] - ETA: 10:16 - rpn_cls: 1.2994 - rpn_regr: 0.0361 - detector_cls: 0.2085 - detector_regr: 0.2086Exception: 'a' cannot be empty unless no samples are taken
 623/1000 [=================>............] - ETA: 9:39 - rpn_cls: 1.2993 - rpn_regr: 0.0359 - detector_cls: 0.2078 - detector_regr: 0.2079Exception: 'a' cannot be empty unless no samples are taken
 627/1000 [=================>............] - ETA: 9:33 - rpn_cls: 1.2983 - rpn_regr: 0.0363 - detector_cls: 0.2078 - detector_regr: 0.2086Exception: 'a' cannot be empty unless no samples are taken
 641/1000 [==================>...........] - ETA: 9:13 - rpn_cls: 1.2704 - rpn_regr: 0.0360 - detector_cls: 0.2083 - detector_regr: 0.2079Exception: 'a' cannot be empty unless no samples are taken
 655/1000 [==================>...........] - ETA: 8:51 - rpn_cls: 1.2727 - rpn_regr: 0.0364 - detector_cls: 0.2069 - detector_regr: 0.2061Exception: 'a' cannot be empty unless no samples are taken
 658/1000 [==================>...........] - ETA: 8:47 - rpn_cls: 1.2748 - rpn_regr: 0.0363 - detector_cls: 0.2066 - detector_regr: 0.2055Average number of overlapping bounding boxes from RPN = 0.975 for 1000 previous iterations
 669/1000 [===================>..........] - ETA: 8:31 - rpn_cls: 1.2730 - rpn_regr: 0.0363 - detector_cls: 0.2063 - detector_regr: 0.2048Exception: 'a' cannot be empty unless no samples are taken
 681/1000 [===================>..........] - ETA: 8:13 - rpn_cls: 1.2872 - rpn_regr: 0.0360 - detector_cls: 0.2067 - detector_regr: 0.2045Exception: 'a' cannot be empty unless no samples are taken
 737/1000 [=====================>........] - ETA: 6:47 - rpn_cls: 1.3013 - rpn_regr: 0.0357 - detector_cls: 0.2062 - detector_regr: 0.2029Exception: 'a' cannot be empty unless no samples are taken
 752/1000 [=====================>........] - ETA: 6:23 - rpn_cls: 1.2946 - rpn_regr: 0.0357 - detector_cls: 0.2070 - detector_regr: 0.2043Exception: 'a' cannot be empty unless no samples are taken
Exception: 'a' cannot be empty unless no samples are taken
 804/1000 [=======================>......] - ETA: 5:02 - rpn_cls: 1.2652 - rpn_regr: 0.0356 - detector_cls: 0.2074 - detector_regr: 0.2041Exception: 'a' cannot be empty unless no samples are taken
Exception: 'a' cannot be empty unless no samples are taken
 821/1000 [=======================>......] - ETA: 4:36 - rpn_cls: 1.2529 - rpn_regr: 0.0356 - detector_cls: 0.2061 - detector_regr: 0.2038Exception: 'a' cannot be empty unless no samples are taken
 861/1000 [========================>.....] - ETA: 3:34 - rpn_cls: 1.2308 - rpn_regr: 0.0354 - detector_cls: 0.2039 - detector_regr: 0.2024Exception: 'a' cannot be empty unless no samples are taken
 887/1000 [=========================>....] - ETA: 2:53 - rpn_cls: 1.2335 - rpn_regr: 0.0354 - detector_cls: 0.2027 - detector_regr: 0.2014Exception: 'a' cannot be empty unless no samples are taken
 896/1000 [=========================>....] - ETA: 2:39 - rpn_cls: 1.2308 - rpn_regr: 0.0354 - detector_cls: 0.2032 - detector_regr: 0.2022Exception: 'a' cannot be empty unless no samples are taken
 901/1000 [==========================>...] - ETA: 2:32 - rpn_cls: 1.2240 - rpn_regr: 0.0354 - detector_cls: 0.2027 - detector_regr: 0.2024Exception: 'a' cannot be empty unless no samples are taken
 941/1000 [===========================>..] - ETA: 1:30 - rpn_cls: 1.2063 - rpn_regr: 0.0355 - detector_cls: 0.2021 - detector_regr: 0.2020Exception: 'a' cannot be empty unless no samples are taken
 950/1000 [===========================>..] - ETA: 1:17 - rpn_cls: 1.2086 - rpn_regr: 0.0353 - detector_cls: 0.2022 - detector_regr: 0.2017Exception: 'a' cannot be empty unless no samples are taken
 957/1000 [===========================>..] - ETA: 1:06 - rpn_cls: 1.1998 - rpn_regr: 0.0354 - detector_cls: 0.2019 - detector_regr: 0.2013Exception: 'a' cannot be empty unless no samples are taken
 990/1000 [============================>.] - ETA: 15s - rpn_cls: 1.1823 - rpn_regr: 0.0352 - detector_cls: 0.2002 - detector_regr: 0.1994Exception: 'a' cannot be empty unless no samples are taken
1000/1000 [==============================] - 1549s 2s/step - rpn_cls: 1.1705 - rpn_regr: 0.0351 - detector_cls: 0.2003 - detector_regr: 0.2003
Mean number of bounding boxes from RPN overlapping ground truth boxes: 1.1244598098530683
Classifier accuracy for bounding boxes from RPN: 0.96103125
Loss RPN classifier: 1.1705147738959663
Loss RPN regression: 0.035061021029221595
Loss Detector classifier: 0.20027804781938904
Loss Detector regression: 0.20025841663591565
Elapsed time: 1566.0965507030487
Total loss decreased from 2.043073903893786 to 1.6061122593804926, saving weights
Epoch 3/30
  18/1000 [..............................] - ETA: 23:44 - rpn_cls: 0.3778 - rpn_regr: 0.0211 - detector_cls: 0.1661 - detector_regr: 0.1960Exception: 'a' cannot be empty unless no samples are taken
  33/1000 [..............................] - ETA: 22:40 - rpn_cls: 0.4898 - rpn_regr: 0.0200 - detector_cls: 0.1940 - detector_regr: 0.2218Exception: 'a' cannot be empty unless no samples are taken
  34/1000 [>.............................] - ETA: 23:32 - rpn_cls: 0.6038 - rpn_regr: 0.0196 - detector_cls: 0.1885 - detector_regr: 0.2152Exception: 'a' cannot be empty unless no samples are taken
  35/1000 [>.............................] - ETA: 24:20 - rpn_cls: 0.5866 - rpn_regr: 0.0192 - detector_cls: 0.1834 - detector_regr: 0.2091Exception: 'a' cannot be empty unless no samples are taken
  68/1000 [=>............................] - ETA: 24:02 - rpn_cls: 0.9404 - rpn_regr: 0.0260 - detector_cls: 0.2152 - detector_regr: 0.2238Exception: 'a' cannot be empty unless no samples are taken
 124/1000 [==>...........................] - ETA: 22:46 - rpn_cls: 0.7525 - rpn_regr: 0.0283 - detector_cls: 0.2162 - detector_regr: 0.2263Exception: 'a' cannot be empty unless no samples are taken
 224/1000 [=====>........................] - ETA: 20:04 - rpn_cls: 0.8341 - rpn_regr: 0.0306 - detector_cls: 0.2380 - detector_regr: 0.2322Exception: 'a' cannot be empty unless no samples are taken
 225/1000 [=====>........................] - ETA: 20:06 - rpn_cls: 0.8377 - rpn_regr: 0.0311 - detector_cls: 0.2379 - detector_regr: 0.2328Exception: 'a' cannot be empty unless no samples are taken
 229/1000 [=====>........................] - ETA: 20:02 - rpn_cls: 0.8512 - rpn_regr: 0.0312 - detector_cls: 0.2375 - detector_regr: 0.2317Exception: 'a' cannot be empty unless no samples are taken
Exception: 'a' cannot be empty unless no samples are taken
 267/1000 [=======>......................] - ETA: 19:07 - rpn_cls: 0.8307 - rpn_regr: 0.0313 - detector_cls: 0.2359 - detector_regr: 0.2268Exception: 'a' cannot be empty unless no samples are taken
 284/1000 [=======>......................] - ETA: 18:41 - rpn_cls: 0.8126 - rpn_regr: 0.0314 - detector_cls: 0.2334 - detector_regr: 0.2271Exception: 'a' cannot be empty unless no samples are taken
 310/1000 [========>.....................] - ETA: 18:15 - rpn_cls: 0.8015 - rpn_regr: 0.0305 - detector_cls: 0.2391 - detector_regr: 0.2340Exception: 'a' cannot be empty unless no samples are taken
 311/1000 [========>.....................] - ETA: 18:14 - rpn_cls: 0.7989 - rpn_regr: 0.0305 - detector_cls: 0.2393 - detector_regr: 0.2341Exception: 'a' cannot be empty unless no samples are taken
 332/1000 [========>.....................] - ETA: 17:39 - rpn_cls: 0.8137 - rpn_regr: 0.0309 - detector_cls: 0.2389 - detector_regr: 0.2325Exception: 'a' cannot be empty unless no samples are taken
 366/1000 [=========>....................] - ETA: 16:50 - rpn_cls: 0.8522 - rpn_regr: 0.0301 - detector_cls: 0.2385 - detector_regr: 0.2326Exception: 'a' cannot be empty unless no samples are taken
 378/1000 [==========>...................] - ETA: 16:38 - rpn_cls: 0.8518 - rpn_regr: 0.0299 - detector_cls: 0.2392 - detector_regr: 0.2310Exception: 'a' cannot be empty unless no samples are taken
 392/1000 [==========>...................] - ETA: 16:19 - rpn_cls: 0.8550 - rpn_regr: 0.0297 - detector_cls: 0.2374 - detector_regr: 0.2317Exception: 'a' cannot be empty unless no samples are taken
Exception: 'a' cannot be empty unless no samples are taken
 394/1000 [==========>...................] - ETA: 16:17 - rpn_cls: 0.8617 - rpn_regr: 0.0296 - detector_cls: 0.2376 - detector_regr: 0.2320Exception: 'a' cannot be empty unless no samples are taken
 402/1000 [===========>..................] - ETA: 16:06 - rpn_cls: 0.8553 - rpn_regr: 0.0295 - detector_cls: 0.2374 - detector_regr: 0.2313Exception: 'a' cannot be empty unless no samples are taken
 403/1000 [===========>..................] - ETA: 16:06 - rpn_cls: 0.8640 - rpn_regr: 0.0294 - detector_cls: 0.2368 - detector_regr: 0.2307Exception: 'a' cannot be empty unless no samples are taken
 406/1000 [===========>..................] - ETA: 16:02 - rpn_cls: 0.8580 - rpn_regr: 0.0294 - detector_cls: 0.2358 - detector_regr: 0.2304Exception: 'a' cannot be empty unless no samples are taken
 408/1000 [===========>..................] - ETA: 15:59 - rpn_cls: 0.8538 - rpn_regr: 0.0293 - detector_cls: 0.2353 - detector_regr: 0.2297Exception: 'a' cannot be empty unless no samples are taken
 410/1000 [===========>..................] - ETA: 16:00 - rpn_cls: 0.8603 - rpn_regr: 0.0293 - detector_cls: 0.2365 - detector_regr: 0.2306Exception: 'a' cannot be empty unless no samples are taken
 449/1000 [============>.................] - ETA: 14:50 - rpn_cls: 0.8317 - rpn_regr: 0.0303 - detector_cls: 0.2409 - detector_regr: 0.2296Exception: 'a' cannot be empty unless no samples are taken
 450/1000 [============>.................] - ETA: 14:49 - rpn_cls: 0.8299 - rpn_regr: 0.0303 - detector_cls: 0.2404 - detector_regr: 0.2291Exception: 'a' cannot be empty unless no samples are taken
 453/1000 [============>.................] - ETA: 14:45 - rpn_cls: 0.8244 - rpn_regr: 0.0302 - detector_cls: 0.2401 - detector_regr: 0.2296Exception: 'a' cannot be empty unless no samples are taken
 456/1000 [============>.................] - ETA: 14:42 - rpn_cls: 0.8190 - rpn_regr: 0.0302 - detector_cls: 0.2400 - detector_regr: 0.2304Exception: 'a' cannot be empty unless no samples are taken
Exception: 'a' cannot be empty unless no samples are taken
 508/1000 [==============>...............] - ETA: 13:07 - rpn_cls: 0.8054 - rpn_regr: 0.0301 - detector_cls: 0.2453 - detector_regr: 0.2326Average number of overlapping bounding boxes from RPN = 1.468 for 1000 previous iterations
 753/1000 [=====================>........] - ETA: 6:20 - rpn_cls: 0.7685 - rpn_regr: 0.0290 - detector_cls: 0.2681 - detector_regr: 0.2384Exception: 'a' cannot be empty unless no samples are taken
 808/1000 [=======================>......] - ETA: 4:54 - rpn_cls: 0.7652 - rpn_regr: 0.0286 - detector_cls: 0.2697 - detector_regr: 0.2379Exception: 'a' cannot be empty unless no samples are taken
 874/1000 [=========================>....] - ETA: 3:12 - rpn_cls: 0.7851 - rpn_regr: 0.0280 - detector_cls: 0.2728 - detector_regr: 0.2366Exception: 'a' cannot be empty unless no samples are taken
 876/1000 [=========================>....] - ETA: 3:09 - rpn_cls: 0.7883 - rpn_regr: 0.0280 - detector_cls: 0.2730 - detector_regr: 0.2368Exception: 'a' cannot be empty unless no samples are taken
1000/1000 [==============================] - 1514s 2s/step - rpn_cls: 0.7901 - rpn_regr: 0.0280 - detector_cls: 0.2801 - detector_regr: 0.2366
Mean number of bounding boxes from RPN overlapping ground truth boxes: 2.093947606142728
Classifier accuracy for bounding boxes from RPN: 0.9311875
Loss RPN classifier: 0.7900940498340653
Loss RPN regression: 0.027997603707684903
Loss Detector classifier: 0.2800911515419757
Loss Detector regression: 0.23664783760532737
Elapsed time: 1514.7052445411682
Total loss decreased from 1.6061122593804926 to 1.3348306426890533, saving weights
Epoch 4/30
 500/1000 [==============>...............] - ETA: 11:39 - rpn_cls: 0.4381 - rpn_regr: 0.0212 - detector_cls: 0.3974 - detector_regr: 0.2233Average number of overlapping bounding boxes from RPN = 3.217 for 1000 previous iterations
1000/1000 [==============================] - 1327s 1s/step - rpn_cls: 0.3523 - rpn_regr: 0.0228 - detector_cls: 0.3813 - detector_regr: 0.2090
Mean number of bounding boxes from RPN overlapping ground truth boxes: 3.972
Classifier accuracy for bounding boxes from RPN: 0.88521875
Loss RPN classifier: 0.3523456276529752
Loss RPN regression: 0.02284885988253518
Loss Detector classifier: 0.38130533212795853
Loss Detector regression: 0.2089984074998647
Elapsed time: 1327.4295721054077
Total loss decreased from 1.3348306426890533 to 0.9654982271633337, saving weights
Epoch 5/30
 500/1000 [==============>...............] - ETA: 9:58 - rpn_cls: 0.4321 - rpn_regr: 0.0219 - detector_cls: 0.3276 - detector_regr: 0.1779Average number of overlapping bounding boxes from RPN = 4.101 for 1000 previous iterations
1000/1000 [==============================] - 1198s 1s/step - rpn_cls: 0.3698 - rpn_regr: 0.0210 - detector_cls: 0.3270 - detector_regr: 0.1719
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.221
Classifier accuracy for bounding boxes from RPN: 0.888875
Loss RPN classifier: 0.36976202109913775
Loss RPN regression: 0.020983538598316955
Loss Detector classifier: 0.32700754186930137
Loss Detector regression: 0.17192463271412997
Elapsed time: 1198.526334285736
Total loss decreased from 0.9654982271633337 to 0.889677734280886, saving weights
Epoch 6/30
 500/1000 [==============>...............] - ETA: 9:58 - rpn_cls: 0.2872 - rpn_regr: 0.0170 - detector_cls: 0.3123 - detector_regr: 0.1640Average number of overlapping bounding boxes from RPN = 4.36 for 1000 previous iterations
1000/1000 [==============================] - 1200s 1s/step - rpn_cls: 0.2852 - rpn_regr: 0.0176 - detector_cls: 0.2996 - detector_regr: 0.1582
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.34
Classifier accuracy for bounding boxes from RPN: 0.89534375
Loss RPN classifier: 0.2852023530111347
Loss RPN regression: 0.01761540567461634
Loss Detector classifier: 0.2996269857697189
Loss Detector regression: 0.1582454919065349
Elapsed time: 1200.2867925167084
Total loss decreased from 0.889677734280886 to 0.7606902363620048, saving weights
Epoch 7/30
 500/1000 [==============>...............] - ETA: 10:00 - rpn_cls: 0.1810 - rpn_regr: 0.0179 - detector_cls: 0.2644 - detector_regr: 0.1492Average number of overlapping bounding boxes from RPN = 4.275 for 1000 previous iterations
1000/1000 [==============================] - 1195s 1s/step - rpn_cls: 0.1706 - rpn_regr: 0.0165 - detector_cls: 0.2527 - detector_regr: 0.1422
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.193
Classifier accuracy for bounding boxes from RPN: 0.9075625
Loss RPN classifier: 0.17058742602418955
Loss RPN regression: 0.016528963487551663
Loss Detector classifier: 0.2527467174325138
Loss Detector regression: 0.14215089913271367
Elapsed time: 1195.6417126655579
Total loss decreased from 0.7606902363620048 to 0.5820140060769687, saving weights
Epoch 8/30
 500/1000 [==============>...............] - ETA: 9:53 - rpn_cls: 0.1200 - rpn_regr: 0.0144 - detector_cls: 0.2374 - detector_regr: 0.1363Average number of overlapping bounding boxes from RPN = 4.197 for 1000 previous iterations
1000/1000 [==============================] - 1188s 1s/step - rpn_cls: 0.1284 - rpn_regr: 0.0147 - detector_cls: 0.2365 - detector_regr: 0.1328
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.226
Classifier accuracy for bounding boxes from RPN: 0.91096875
Loss RPN classifier: 0.12843744032671736
Loss RPN regression: 0.014655288683003163
Loss Detector classifier: 0.23653077100589873
Loss Detector regression: 0.13284638916701078
Elapsed time: 1188.3321959972382
Total loss decreased from 0.5820140060769687 to 0.51246988918263, saving weights
Epoch 9/30
 500/1000 [==============>...............] - ETA: 9:51 - rpn_cls: 0.1556 - rpn_regr: 0.0158 - detector_cls: 0.2194 - detector_regr: 0.1291Average number of overlapping bounding boxes from RPN = 4.217 for 1000 previous iterations
1000/1000 [==============================] - 1183s 1s/step - rpn_cls: 0.1426 - rpn_regr: 0.0158 - detector_cls: 0.2201 - detector_regr: 0.1300
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.288
Classifier accuracy for bounding boxes from RPN: 0.9191875
Loss RPN classifier: 0.14257219724387313
Loss RPN regression: 0.015822239190714755
Loss Detector classifier: 0.22013872766261922
Loss Detector regression: 0.12998562338761985
Elapsed time: 1183.2025072574615
Total loss decreased from 0.51246988918263 to 0.5085187874848269, saving weights
Epoch 10/30
 500/1000 [==============>...............] - ETA: 9:50 - rpn_cls: 0.1075 - rpn_regr: 0.0134 - detector_cls: 0.2095 - detector_regr: 0.1259Average number of overlapping bounding boxes from RPN = 4.359 for 1000 previous iterations
1000/1000 [==============================] - 1183s 1s/step - rpn_cls: 0.0907 - rpn_regr: 0.0133 - detector_cls: 0.2139 - detector_regr: 0.1252
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.39
Classifier accuracy for bounding boxes from RPN: 0.9199375
Loss RPN classifier: 0.09071712274105843
Loss RPN regression: 0.013278957593429367
Loss Detector classifier: 0.21387047112639992
Loss Detector regression: 0.12517282254248857
Elapsed time: 1183.608183145523
Total loss decreased from 0.5085187874848269 to 0.4430393740033763, saving weights
Epoch 11/30
 500/1000 [==============>...............] - ETA: 9:50 - rpn_cls: 0.1339 - rpn_regr: 0.0130 - detector_cls: 0.2009 - detector_regr: 0.1228Average number of overlapping bounding boxes from RPN = 4.423 for 1000 previous iterations
1000/1000 [==============================] - 1177s 1s/step - rpn_cls: 0.1120 - rpn_regr: 0.0130 - detector_cls: 0.1962 - detector_regr: 0.1201
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.43
Classifier accuracy for bounding boxes from RPN: 0.92371875
Loss RPN classifier: 0.11201754032767532
Loss RPN regression: 0.013036662160906418
Loss Detector classifier: 0.19618703436944634
Loss Detector regression: 0.12005537033919245
Elapsed time: 1177.5753977298737
Total loss decreased from 0.4430393740033763 to 0.4412966071972205, saving weights
Epoch 12/30
 500/1000 [==============>...............] - ETA: 9:48 - rpn_cls: 0.1095 - rpn_regr: 0.0134 - detector_cls: 0.2028 - detector_regr: 0.1137Average number of overlapping bounding boxes from RPN = 4.514 for 1000 previous iterations
1000/1000 [==============================] - 1178s 1s/step - rpn_cls: 0.0860 - rpn_regr: 0.0133 - detector_cls: 0.1958 - detector_regr: 0.1125
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.527
Classifier accuracy for bounding boxes from RPN: 0.9235
Loss RPN classifier: 0.08596931890827664
Loss RPN regression: 0.01327312182757305
Loss Detector classifier: 0.19582468541525305
Loss Detector regression: 0.11254614771762862
Elapsed time: 1178.5225086212158
Total loss decreased from 0.4412966071972205 to 0.40761327386873136, saving weights
Epoch 13/30
 500/1000 [==============>...............] - ETA: 9:48 - rpn_cls: 0.0502 - rpn_regr: 0.0112 - detector_cls: 0.1982 - detector_regr: 0.1117Average number of overlapping bounding boxes from RPN = 4.491 for 1000 previous iterations
1000/1000 [==============================] - 1181s 1s/step - rpn_cls: 0.1130 - rpn_regr: 0.0114 - detector_cls: 0.1946 - detector_regr: 0.1124
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.592
Classifier accuracy for bounding boxes from RPN: 0.9255
Loss RPN classifier: 0.11304672675534533
Loss RPN regression: 0.011364717209726222
Loss Detector classifier: 0.1946129861921072
Loss Detector regression: 0.11237953047640621
Elapsed time: 1181.5733127593994
Epoch 14/30
 500/1000 [==============>...............] - ETA: 9:48 - rpn_cls: 0.0550 - rpn_regr: 0.0129 - detector_cls: 0.1888 - detector_regr: 0.1084Average number of overlapping bounding boxes from RPN = 4.631 for 1000 previous iterations
1000/1000 [==============================] - 1176s 1s/step - rpn_cls: 0.0529 - rpn_regr: 0.0122 - detector_cls: 0.1790 - detector_regr: 0.1074
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.526
Classifier accuracy for bounding boxes from RPN: 0.928
Loss RPN classifier: 0.05291135361284409
Loss RPN regression: 0.012211065563431475
Loss Detector classifier: 0.17898283801041542
Loss Detector regression: 0.10739262754330411
Elapsed time: 1175.6671690940857
Total loss decreased from 0.40761327386873136 to 0.3514978847299951, saving weights
Epoch 15/30
 500/1000 [==============>...............] - ETA: 9:48 - rpn_cls: 0.0946 - rpn_regr: 0.0121 - detector_cls: 0.1792 - detector_regr: 0.1052Average number of overlapping bounding boxes from RPN = 4.528 for 1000 previous iterations
1000/1000 [==============================] - 1175s 1s/step - rpn_cls: 0.0835 - rpn_regr: 0.0123 - detector_cls: 0.1814 - detector_regr: 0.1082
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.567
Classifier accuracy for bounding boxes from RPN: 0.929625
Loss RPN classifier: 0.08346273674510624
Loss RPN regression: 0.012264760338090127
Loss Detector classifier: 0.18144172688480467
Loss Detector regression: 0.1081976878521964
Elapsed time: 1175.355320930481
Epoch 16/30
 500/1000 [==============>...............] - ETA: 9:45 - rpn_cls: 0.0860 - rpn_regr: 0.0120 - detector_cls: 0.1905 - detector_regr: 0.1129Average number of overlapping bounding boxes from RPN = 4.655 for 1000 previous iterations
1000/1000 [==============================] - 1170s 1s/step - rpn_cls: 0.0625 - rpn_regr: 0.0123 - detector_cls: 0.1956 - detector_regr: 0.1108
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.825
Classifier accuracy for bounding boxes from RPN: 0.921875
Loss RPN classifier: 0.062488714537392
Loss RPN regression: 0.01228582869566162
Loss Detector classifier: 0.19558007343299688
Loss Detector regression: 0.11084113984834403
Elapsed time: 1170.3801629543304
Epoch 17/30
 500/1000 [==============>...............] - ETA: 9:43 - rpn_cls: 0.1112 - rpn_regr: 0.0115 - detector_cls: 0.1834 - detector_regr: 0.1040Average number of overlapping bounding boxes from RPN = 4.831 for 1000 previous iterations
1000/1000 [==============================] - 1166s 1s/step - rpn_cls: 0.0888 - rpn_regr: 0.0113 - detector_cls: 0.1768 - detector_regr: 0.1010
Mean number of bounding boxes from RPN overlapping ground truth boxes: 4.784
Classifier accuracy for bounding boxes from RPN: 0.92784375
Loss RPN classifier: 0.08877437161920836
Loss RPN regression: 0.011292990233610908
Loss Detector classifier: 0.1767943933773786
Loss Detector regression: 0.10098005435289815
Elapsed time: 1166.283566236496
